pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
--this is a prototype to test spawning buildings
--and scrolling the map
--it should be noted that the map is not actually
--scrolling, but rather the player and buildings
--are moving relative to the map
--this prototype should spawn buildings as the player moves to new areas
--and despawn buildings as the player moves away from them (~100 tiles away)
function _init()
 --direction
 p_sx,p_sy=0,0
 --animation variable
 p_flip=false	
 p_spr=2

 --building variables
 b_spr=4
 b_x,b_y=30,30
 b_sx,b_sy=0,0

 
 --map functions
 map_x,map_y=0,0
end

function _update()
	--update player
	update_player()
	--update building
	update_building()
	--update map
	map_x+=p_sx
	map_y+=p_sy
end

function _draw()
 cls(3)
 --draw scrolling map
 for i=0,2 do
 	for j=0,2 do
 		map(0,0,
 		map_x%128+128*i-128,
 		map_y%128+128*j-128)
	end
 end
 draw_building()
 draw_player()
 print(p_sx, 10, 10)
 print(p_sy, 10, 16)
 print(b_x, 10, 22)
 print(b_y, 10, 28)
end

function draw_building()
	spr(b_spr,b_x,b_y,1,1,false,false)
end

function draw_player()
	if not p_flip then
		if(p_sx>0)p_flip=true
	else
		if(p_sx<0)p_flip=false
	end
 	--draw player
  	spr(p_spr,60,60,1,1,p_flip)
end

function update_building()
	--the buildings simulated x and y should stay relative to the player
	b_sx,b_sy=0,0
	if p_sx>0 then
		b_sx=1
	end
	if p_sx<0 then
		b_sx=-1
	end
	if p_sy>0 then
		b_sy=1
	end
	if p_sy<0 then
		b_sy=-1
	end
	--update building position
	b_x+=b_sx
	b_y+=b_sy
end

function update_player()
	p_sx,p_sy=0,0
	if btn(⬅️) then
		p_sx=1
	end
	if btn(➡️) then
		p_sx=-1
	end
 	if btn(⬆️) then
		p_sy=1
	end
 	if btn(⬇️) then
		p_sy=-1
	end
end
__gfx__
00000000000000000000099000000000555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000a9899000000005a5a5a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000000000000a99777000c80005a5a5a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000000000000999999066c8660555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000a999900067777605a5a5a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000000066009999099677777765a5a5a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000056669995990065577556555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000555550999599065566556554445500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
